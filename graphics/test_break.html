<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
	<title>Test Break</title>
	<link rel="stylesheet" href="style/layout.css">
	<link rel="stylesheet" href="style/font/SF Pixelate.css">
	<script src="components/gsap/src/minified/TweenMax.min.js"></script>
	<link rel="import" href="components/iron-flex-layout/iron-flex-layout.html">
	<link rel="import" href="components/iron-flex-layout/iron-flex-layout-classes.html">
	<link rel="import" href="components/vaadin-combo-box/vaadin-combo-box.html">
	<link rel="import" href="elements/gdq-break-bids/gdq-break-bids.html">
	<link rel="import" href="elements/gdq-break-prizes/gdq-break-prizes.html">
	<style>
		body {
			opacity: 1;
		}
	</style>
</head>
<body>
	<test-app></test-app>

	<dom-module id="test-app">
		<template>
			<style include="iron-flex iron-flex-alignment">
				:host {
					@apply(--layout-horizontal);
				}

				.section {
					margin: 8px;
				}

				gdq-break-bids,
				gdq-break-prizes {
					background: url("img/break/screen_static.png");
					width: 532px!important;
					height: 305px;
				}
			</style>

			<div class="section layout vertical">
				<gdq-break-bids id="bids"></gdq-break-bids>
				<vaadin-combo-box
					label="All Bids"
					items="[[bids]]"
					item-label-path="public"
					on-selected-item-changed="_selectedBidChanged">
				</vaadin-combo-box>
			</div>

			<div class="section layout vertical">
				<gdq-break-prizes id="prizes"></gdq-break-prizes>
				<vaadin-combo-box
					label="All Prizes"
					items="[[prizes]]"
					item-label-path="name"
					on-selected-item-changed="_selectedPrizeChanged">
				</vaadin-combo-box>
			</div>
		</template>

		<script>
			const allBids = nodecg.Replicant('allBids');
			const allPrizes = nodecg.Replicant('allPrizes');

			Polymer({
				is: 'test-app',

				ready() {
					allBids.on('change', newVal => {
						this.bids = newVal.slice(0);
					});

					allPrizes.on('change', newVal => {
						this.prizes = newVal.slice(0);
					});
				},

				_selectedBidChanged(e) {
					const bid = e.detail.value;
					this.debounce('showBid', () => {
						this.showBid(bid);
					}, 50);
				},

				_selectedPrizeChanged(e) {
					const prize = e.detail.value;
					this.debounce('showPrize', () => {
						this.showPrize(prize);
					}, 50);
				},

				showBid(bid) {
					if (!bid) {
						return;
					}

					const bidsArr = [bid];
					this.$.bids.showBid(bid, 0, bidsArr);
				},

				showPrize(prize) {
					if (!prize) {
						return;
					}

					const prizesArr = [prize];
					this.$.prizes.showPrize(prize, 0, prizesArr);
				}
			});
		</script>
	</dom-module>
</body>
</html>
